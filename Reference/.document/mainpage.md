RPGアツマールAPI for Unity {#mainpage}
===

# RPGアツマールAPI for Unityについて

## RPGアツマールとは

　[RPGアツマール]とは、株式会社ドワンゴによって運営されているゲームプラットフォームサイトです。  
このゲームプラットフォームでは、HTML5によって作成されたゲームなどを  
一般ユーザー（ニコニコの一般会員の事ではありません）から自由にアップロードし  
公開出来る様になっています。  
  

　また、公開されたゲームは、他の一般ユーザーからも遊ぶことが出来て  
[ニコニコ動画]のような仕組みと同様、ゲームに対してコメントを送ることも可能です。  

## RPGアツマールAPIとは

　作成したゲームを、[RPGアツマール]と連携するためにゲームから呼び出せる[RPGアツマール]の機能です。  
主に、ゲームに必要なセーブ機能や音量制御なども含まれます。  
セーブ機能には[RPGアツマール]サーバー上にユーザー会員アカウントと紐付けられ、他のコンピュータからでも  
同アカウントでログインする事が出来れば、同じセーブデータからゲームを再開する事が可能になったりします。
  

　[RPGアツマール]公式が発表している[RPGアツマールAPIリファレンス]などもありますので  
ご興味がある方は、参考に見てみると良いかもしれません。

## RPGアツマールAPI for Unityとは

　現在、公式にて提供されているAPIは、JavaScriptからの呼び出しを想定しているため  
そのままでは、[Unity]ゲームエンジンから呼び出すことは出来ません。  
[Unity]ゲームエンジンから呼び出すには、[RPGアツマール]APIとの繋ぎ込みをするために  
ネイティブプラグインを実装しなければなりませが、呼び出せるようにしたのが  
"RPGアツマールAPI for Unity"です。  
また、RPGアツマールAPI for Unityの[公式ブログ]も開設され、様々な情報を発信する事があるので  
リファレンスに記載されていない内容など、[公式ブログ]で確認するとが出来ます。

## API対応一覧（2018-12-08 段階）

| API | 対応 | Comment. |
| :--- | :---: | :--- |
| コメントAPI | Full | なし |
| コントローラAPI | Full | なし |
| サーバーセーブAPI | Full | なし |
| マスターボリュームAPI | Full | なし |
| 外部リンクAPI | Full | なし |
| クエリ取得API | Full | なし |
| 作者情報表示API | Full | なし |
| スコアボードAPI | Full | なし |
| スクリーンショットAPI | Full | なし |
| 解像度変更機能 | Full | RPGアツマールのゲーム画面の「拡大」および「フルスクリーン」に対する解像度変化に追従します |
| モバイル動作 | △ | RPGアツマールWebGLテンプレートを使えば起動出来ますが、Unityゲームエンジンがまだ完全ではないため動作保証はありません |

# ソフトウェア履歴

* v1.2.0 (2018-12-08)
  * モバイル版RPGアツマールでも起動できるようになりました
  * RPGアツマールの新スクリーンショットAPIに対応しました
  * RPGアツマール向けWebGLテンプレートを生成出来るようになりました
  * コントローラAPIにて、左ボタンが決定ボタンとして動作してしまう問題の修正
  * エディタツールがプログラムコンパイル時にエラーで閉じられてしまう問題の修正
  * 新スクリーンショットAPI対応に伴い「General.SetDefaultScreenShotImgeData」関数が"Obsolete"になりました
* v1.1.1 (2018-12-02)
  * スコアボードの送信スコア値が、規定値範囲外の場合例外をスローするようになりました
  * "DevelopmentBuild"でビルドされた場合に、ライブラリがダミー動作するように変更
* v1.1.0 (2018-11-24)
  * スクリーンショットAPIに対応
* v1.0.0 (2018-11-18)
  * 初版リリース

# 環境の準備

## 動作条件

"RPGアツマールAPI for Unity"は、UnityPackageManager(upm)形式による頒布をしています。  
さらに、パッケージは、C#7.3以上の構文を利用しているため、[Unity]エンジンバージョンは 2018.3系 以上が必須となっております。  

## ダウンロード

[このページ](https://bitbucket.org/Sinoa/rpgatsumaruapiforunity/downloads/)から最新のバージョンをダウンロードして下さい。  
参考画面は以下のとおりです。  
![](@ref image006.jpg)

## Unityへインポート

この手順は、[Unity]のプロジェクトを作るたびに必要な手順です。  
[Unity]エディタ環境へインポートする方法については、 @subpage import のサブページを参照して下さい。

# 各種APIのクイックスタート

## 初期化をしよう

"PRGアツマールAPI for Unity"を動かすためには必ず、プラグインの初期化をしなければなりません。  
以下のあらゆる機能を使う前に必ず実行しましょう。  
@subpage initapi に詳しい実装方法が記載されています。

## サーバーセーブをしよう

プレイヤーが、ゲームのプレイ情報を保存した内容を、別のコンピュータでも再開したいと思うでしょう。  
その場合は[RPGアツマール]サーバー上にゲームを記録することで実現出来ます。  
@subpage serversave に詳しい実装方法が記載されています。

## 音量を制御しよう

ゲーム音量は適正ですか？誤ったゲーム音量を設定していると、プレイヤーのコンピュータのスピーカーを壊してしまったり  
プレイヤーの耳への直接的なダメージを与えてしまいます。さらに、音量はプレイヤーの環境によって  
大きく異なるため、適切な音量調整が出来る機能が無いといけません、音量調整は[RPGアツマール]の音量調整バー  
によって、調整出来るようになっています。ただし、この音量調整機能は正しくハンドリングしなければならないため  
この機能をサポートします。  
@subpage volumecontrol に詳しい実装方法が記載されています。

## コメントの流れを制御しよう

[RPGアツマール]には、[ニコニコ動画]と同様にユーザーコメント機能があります。  
ただし、動画と違いゲームは不規則かつ順不同な時間の流れがあるため  
[RPGアツマール]サーバーにゲーム内時間軸を通知する必要があります。  
@subpage commentcontrol に詳しい実装方法が記載されています。

## コントローラの入力を受け取ろう

[RPGアツマール]にはバーチャルコントローラが搭載されており  
物理キーによる操作以外にもゲームを操作することが可能になります。  
API自体もUnityの Input クラスのような振る舞いをするように設計されています。  
@subpage virtualcontroller に詳しい実装方法が記載されています。

## 外部リンクに誘導しよう

ゲーム側から、公式サイトへの誘導や攻略サイトなど、様々な外部サイトへ誘導したいことがあるでしょう  
その場合は、[RPGアツマール]の外部リンク機能を使い、プレイヤーに外部リンクを開く表示をしなければなりません。  
@subpage outsidelink に詳しい実装方法が記載されています。

## URLに添えられたパラメータを取り出そう

外部サイトから、パラメータ付きのリンクを開くことにより、どこからゲームを起動されたのか  
専用のユーザーコードによる起動で、特別なアイテムを付与したりといった事などが出来ます。  
@subpage queryget に詳しい実装方法が記載されています。

## 作者の情報を表示しよう

作られたゲームが、どの作者によって作られたのか、他の関連ゲームがあるかをプレイヤーに伝えたい時があるでしょう  
その場合は、[RPGアツマール]の作者情報表示機能を、使うことが出来ます。  
@subpage creatordisplay に詳しい実装方法が記載されています。

## スコアボードを表示したり送信したりしよう

ゲームで獲得したスコアなどを、他のプレイヤーと競争させたいと時があるでしょう  
その場合は、[RPGアツマール]のスコアボード機能を、使うことが出来ます。  
@subpage scoreboard に詳しい実装方法が記載されています。

## スクリーンショットを撮って送信しよう

プレイヤーがゲーム中に起きた出来事をキャプチャしたり  
ゲーム側からのコントロールして記念写真としてキャプチャしたいことがあるでしょう  
また、キャプチャした映像はTwitterなどで、皆に自慢したいことがあります。  
その場合は、[RPGアツマール]のスクリーンショット機能を、使うことが出来ます。  
@subpage screenshot に詳しい実装方法が記載されています。

## モバイル版RPGアツマールで起動出来るようにしよう

[RPGアツマール]では、スマートフォン向けにも展開されており  
[RPGアツマール]製ゲームもプレイすることが出来ますが、ゲーム側が起動出来るように  
なっていなければ、正しく起動することが出来ません。  
RPGアツマールAPI for Unityでは、Unityゲームでも起動出来るように対応しました。  
次の項目にある @subpage webgltemplate を確認すれば起動が可能になります。

## WebGLテンプレートを作ろう

Unityにて、WebGL向けビルドをした場合、通常はUnityが提供している汎用起動画面が表示されます。  
ゲームがだんだん完成に近づいてくると、起動時のアイコンなどを変えたくなるでしょう。  
RPGアツマールAPI for Unityでは、その起動画面を簡単に作るためのエディタを搭載しています。  
@subpage webgltemplate に詳しい使い方が記載されています。

## その他の機能

解像度の変化に対しては、自動的に行われるためゲームから特別な操作は必要ありません。  

[RPGアツマール]: https://game.nicovideo.jp/atsumaru/ "RPGアツマール"
[ニコニコ動画]: https://www.nicovideo.jp/video_top "ニコニコ動画"
[RPGアツマールAPIリファレンス]: https://atsumaru.github.io/api-references/ "RPGアツマールAPIリファレンス"
[Unity]: https://unity3d.com/jp "Unity"
[公式ブログ]: https://rpgatsumaruapiforunity.sinoa.ws/blog/ "公式ブログ"
